name: Label issues
on:
  issues:
    types:
      - reopened
      - opened
env:
  ISSUE_BODY: ${{ github.event.issue.body }}

jobs:
  label_issues:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    steps:
      - uses: actions/github-script@v6
        with:
          script: |
            
            
            const productsStringRegex = /### Product\(s\)\s*([\w,\h]*)/;
            var productsString = productsStringRegex.exec(process.env.ISSUE_BODY);
            
            console.log(productsString);
            
            const productsArrayRegex = /(\w+)[,\s]?/g;
            console.log(productsArrayRegex.exec(productsString));
            
            console.log(process.env.ISSUE_BODY);
          
            github.rest.issues.addLabels({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              labels: ["triage"]
            })